import{V as v,C as L}from"./CartelaBingo-DR1qabQb.js";import{D as M}from"./DefaultLayout-CSwyDPM8.js";import{i as k}from"./indexedDbService-Ck-znMg5.js";import{d as R,r as C,Q as S,c as b,w as e,V as T,o as c,a as s,b as h,e as i,S as N,T as p,H as w,W as E,U as x,X as O}from"./index-Dx2TXhpW.js";import{V as o,a as n,b as W,c as A,_ as U}from"./VMain-BC-MdHY-.js";import{a as g,b as z,d as F}from"./VCard-BEeq-ZDN.js";const B=m=>{const _=Math.floor(Math.random()*76);if(!(m.length>74))return m.includes(_)?B(m):_},H=R({__name:"index",setup(m){const j=T().params.id,a=C(),y=C(null),G=async()=>{const u=await k.getOneGame(+j);u&&(a.value=u)},D=u=>{var t;const r=Object.values(u.ticketNumbers).flatMap(l=>l).filter(l=>l);let d=!0;for(let l of r){if(!d)break;d=!!((t=a.value)!=null&&t.drawnNumbers.includes(l))}return d},I=()=>{var r,d,t;if(!(a!=null&&a.value)||((r=a.value.winners)==null?void 0:r.length)>0)return;const u=B(((d=a.value)==null?void 0:d.drawnNumbers)||[]);a.value.drawnNumbers.push(u),a.value.drawnNumbers=[...((t=a.value)==null?void 0:t.drawnNumbers)||[]],y.value=u,a.value.players.forEach(l=>{var f;D(l)&&((f=a.value)==null||f.winners.push(l))}),k.updateGame(Number(a.value.id),{...a.value,winners:[...a.value.winners],finished:a.value.winners.length>0,drawnNumbers:[...a.value.drawnNumbers||[]],lastNumber:u}),a.value.winners.length>0&&(a.value.finished=!0,window.alert(`BINGO!!! Vencedor(es): ${a.value.winners.map(l=>l.name)}`))};return S(()=>G()),(u,r)=>(c(),b(M,null,{default:e(()=>[s(A,{class:"mt-5"},{default:e(()=>{var d;return[s(o,{class:"d-flex justify-center mb-4"},{default:e(()=>[s(n,{cols:"12",md:"8"},{default:e(()=>r[0]||(r[0]=[h("h2",{class:"text-center"},"B I N G O",-1)])),_:1})]),_:1}),s(o,{class:"d-flex justify-center mb-4"},{default:e(()=>[s(n,{cols:"12",md:"4"},{default:e(()=>{var t;return[s(W,{class:"mx-auto d-block",onClick:I,color:"primary",disabled:(t=a.value)==null?void 0:t.finished},{default:e(()=>r[1]||(r[1]=[i(" CALL A NUMBER ")])),_:1},8,["disabled"])]}),_:1})]),_:1}),(d=a.value)!=null&&d.finished?(c(),b(o,{key:0,class:"mb-4"},{default:e(()=>[s(n,{cols:"12"},{default:e(()=>r[2]||(r[2]=[h("h2",{class:"text-center"},"WINNER(S):",-1)])),_:1}),(c(!0),N(w,null,p(a.value.winners,t=>(c(),b(n,{cols:"12",key:t.name,class:"mb-2"},{default:e(()=>[s(v,{class:"pa-3 text-center winner-card"},{default:e(()=>[i(x(t.name),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):E("",!0),s(g,{class:"mb-4"},{default:e(()=>[s(z,null,{default:e(()=>[s(o,{class:"d-flex justify-center align-center"},{default:e(()=>[s(n,{cols:"12",md:"6",class:"text-center"},{default:e(()=>r[3]||(r[3]=[i(" Last called number: ")])),_:1}),s(n,{cols:"12",md:"6",class:"text-center"},{default:e(()=>[s(v,{class:"number-display"},{default:e(()=>{var t;return[i(x(y.value||((t=a.value)==null?void 0:t.lastNumber)),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(g,{class:"mb-4"},{default:e(()=>[s(F,null,{default:e(()=>[s(o,{class:"d-flex justify-center"},{default:e(()=>[s(n,{cols:"12"},{default:e(()=>[s(o,null,{default:e(()=>[(c(),N(w,null,p(75,t=>s(n,{cols:"2",key:t,class:"d-flex justify-center"},{default:e(()=>{var l;return[s(v,{class:O(["number-cell",{"selected-number":(l=a.value)==null?void 0:l.drawnNumbers.includes(t)}])},{default:e(()=>[i(x(t),1)]),_:2},1032,["class"])]}),_:2},1024)),64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(o,{class:"d-flex justify-center"},{default:e(()=>[s(n,{cols:"12",md:"8"},{default:e(()=>[s(o,null,{default:e(()=>{var t;return[(c(!0),N(w,null,p((t=a.value)==null?void 0:t.players,(l,f)=>(c(),b(n,{cols:"12",md:"6",key:f,class:"mb-4"},{default:e(()=>{var V;return[s(L,{"player-name":l.name,"ticket-numbers":l.ticketNumbers,selecteds:(V=a.value)==null?void 0:V.drawnNumbers},null,8,["player-name","ticket-numbers","selecteds"])]}),_:2},1024))),128))]}),_:1})]),_:1})]),_:1})]}),_:1})]),_:1}))}}),P=U(H,[["__scopeId","data-v-0d8eb440"]]);export{P as default};
